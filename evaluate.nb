(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27264,        579]
NotebookOptionsPosition[     24131,        535]
NotebookOutlinePosition[     24565,        552]
CellTagsIndexPosition[     24522,        549]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"tmp1", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         RowBox[{
         "\"\</data/mri_\>\"", "<>", "Sub", "<>", "\"\<_t1.mat\>\""}]}], 
        "}"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"256", ",", "1", ",", "256", ",", "256"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.753749285348469*^9, 3.7537492873332*^9}, 
   3.755917857442259*^9, 3.757110454508564*^9, {3.757110709419299*^9, 
   3.757110738829692*^9}, {3.757111491878656*^9, 3.757111502766163*^9}, {
   3.757111596775461*^9, 3.7571115967792664`*^9}, {3.7571116561852293`*^9, 
   3.757111763137989*^9}, {3.7571117951246843`*^9, 3.757111795127433*^9}, {
   3.757111829949964*^9, 3.75711182995364*^9}, {3.7571120171593113`*^9, 
   3.757112069905229*^9}, 3.757115552235654*^9, {3.757115696454095*^9, 
   3.757115706325918*^9}, 3.7571157725425158`*^9, 3.757115804886653*^9, {
   3.757213409145422*^9, 3.757213409146768*^9}, {3.757213443671958*^9, 
   3.7572134436736917`*^9}, {3.75721347968559*^9, 3.757213479686887*^9}, {
   3.75721363107032*^9, 3.757213631072834*^9}, {3.757213886960227*^9, 
   3.757213886962427*^9}, {3.766367132981717*^9, 3.7663672226588984`*^9}, 
   3.766458475893057*^9, 3.7664585172190523`*^9, 3.7664585581253977`*^9, 
   3.766458795638509*^9, 3.766458829413493*^9, 3.866779082862344*^9, {
   3.8667830674375343`*^9, 3.8667830860621843`*^9}, 3.866783446964397*^9, 
   3.86678384786841*^9, 3.866784271975339*^9, 3.866849345935853*^9, {
   3.867718287557333*^9, 3.8677183377853928`*^9}, 3.8677184641700068`*^9, 
   3.8677197080599117`*^9, {3.867723017510147*^9, 3.867723057477578*^9}, {
   3.867726474952414*^9, 3.867726488188808*^9}, {3.8680702058303947`*^9, 
   3.868070206503541*^9}, {3.8686491648469343`*^9, 3.868649233837736*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"8dd0bccb-aa89-453b-9118-092479b0adb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp2", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         RowBox[{
         "\"\</data/mri_\>\"", "<>", "Sub", "<>", "\"\<_t2.mat\>\""}]}], 
        "}"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"256", ",", "1", ",", "256", ",", "256"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.753749285348469*^9, 3.7537492873332*^9}, 
   3.755917857442259*^9, 3.757110454508564*^9, {3.757110709419299*^9, 
   3.757110738829692*^9}, {3.757111491878656*^9, 3.757111502766163*^9}, {
   3.757111596775461*^9, 3.7571115967792664`*^9}, {3.7571116561852293`*^9, 
   3.757111763137989*^9}, {3.7571117951246843`*^9, 3.757111795127433*^9}, {
   3.757111829949964*^9, 3.75711182995364*^9}, {3.7571120171593113`*^9, 
   3.757112069905229*^9}, 3.757115552235654*^9, {3.757115696454095*^9, 
   3.757115706325918*^9}, 3.7571157725425158`*^9, 3.757115804886653*^9, {
   3.757213409145422*^9, 3.757213409146768*^9}, {3.757213443671958*^9, 
   3.7572134436736917`*^9}, {3.75721347968559*^9, 3.757213479686887*^9}, {
   3.75721363107032*^9, 3.757213631072834*^9}, {3.757213886960227*^9, 
   3.757213886962427*^9}, {3.766367132981717*^9, 3.7663672226588984`*^9}, 
   3.766458475893057*^9, 3.7664585172190523`*^9, 3.7664585581253977`*^9, 
   3.766458795638509*^9, 3.766458829413493*^9, 3.866779082862344*^9, {
   3.8667830674375343`*^9, 3.8667830860621843`*^9}, 3.866783446964397*^9, 
   3.86678384786841*^9, 3.866784271975339*^9, 3.866849345935853*^9, {
   3.867718287557333*^9, 3.8677183377853928`*^9}, 3.8677184641700068`*^9, 
   3.8677197080599117`*^9, {3.867723017510147*^9, 3.867723057477578*^9}, {
   3.867726474952414*^9, 3.867726488188808*^9}, {3.8680702058303947`*^9, 
   3.868070206503541*^9}, {3.8686491648469343`*^9, 3.8686492485663443`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"93d144e9-e8d9-411a-9969-7f066bb95219"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Dir", "==", "\"\<Sag\>\""}], ",", 
    RowBox[{"T1ana", "=", "tmp1"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7537669188883667`*^9, 3.7537669231119633`*^9}, {
   3.753769327780789*^9, 3.7537693596920977`*^9}, {3.7559134020705833`*^9, 
   3.755913430056024*^9}, {3.755914193418326*^9, 3.755914205564002*^9}, 
   3.755914794881708*^9, {3.755914865837429*^9, 3.755914871229534*^9}, {
   3.75591502888065*^9, 3.755915029201831*^9}, 3.756177125211439*^9, {
   3.756503585426865*^9, 3.756503585537511*^9}, {3.757204378152286*^9, 
   3.757204378834485*^9}, 3.759645209735409*^9, 3.862608621219646*^9, {
   3.8626088567201853`*^9, 3.862608857510589*^9}, 3.866683368309052*^9, {
   3.866766782063569*^9, 3.866766798390678*^9}, {3.8667674318485527`*^9, 
   3.866767515407946*^9}, {3.867723064957465*^9, 3.8677230764137383`*^9}, {
   3.867723959344001*^9, 3.867723959880196*^9}, {3.867724362078237*^9, 
   3.867724363085569*^9}, 3.867727785995184*^9, {3.867727962724784*^9, 
   3.867727967812752*^9}, {3.867728039326356*^9, 3.867728087800199*^9}, 
   3.8677281767445183`*^9, 3.867728255981028*^9, 3.867728319933713*^9, 
   3.867728409636793*^9, 3.867728462164782*^9, 3.867728515723906*^9, 
   3.868657958127645*^9},ExpressionUUID->"f065d9c2-0e59-4c75-b90a-\
d7a88e57caca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Dir", "==", "\"\<Sag\>\""}], ",", 
    RowBox[{"T2ana", "=", "tmp2"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{3.8677281778228283`*^9, 3.867728260325677*^9, 
  3.8677283209007883`*^9, 3.8677284103087387`*^9, 3.867728463379874*^9, 
  3.86772851645932*^9, 
  3.8686579581288652`*^9},ExpressionUUID->"32f9a0b7-5360-4a7d-8dee-\
0ac4a191319b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Dir", "==", "\"\<Cor\>\""}], ",", 
     RowBox[{"T1ana", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"tmp1", ",", 
        RowBox[{"1", "<->", "3"}]}], "]"}]}]}], "]"}], ";"}], " "}]], "Input",\

 CellChangeTimes->{{3.7537669188883667`*^9, 3.7537669231119633`*^9}, {
   3.753769327780789*^9, 3.7537693596920977`*^9}, {3.7559134020705833`*^9, 
   3.755913430056024*^9}, {3.755914193418326*^9, 3.755914205564002*^9}, 
   3.755914794881708*^9, {3.755914865837429*^9, 3.755914871229534*^9}, {
   3.75591502888065*^9, 3.755915029201831*^9}, 3.756177125211439*^9, {
   3.756503585426865*^9, 3.756503585537511*^9}, {3.757204378152286*^9, 
   3.757204378834485*^9}, 3.759645209735409*^9, 3.862608621219646*^9, {
   3.8626088567201853`*^9, 3.862608857510589*^9}, 3.866683368309052*^9, {
   3.866766782063569*^9, 3.866766798390678*^9}, {3.8667674318485527`*^9, 
   3.8667674951121693`*^9}, {3.8671827766277*^9, 3.867182805497217*^9}, {
   3.867723079909449*^9, 3.86772311842938*^9}, {3.867723964159751*^9, 
   3.867723964592095*^9}, 3.8677243667981443`*^9, 3.867728321476737*^9, 
   3.867728410916359*^9, {3.8677284465331497`*^9, 3.867728526531991*^9}, 
   3.867728614091489*^9, 3.868649259725922*^9, 
   3.86865796933985*^9},ExpressionUUID->"7ceebb09-2146-4b0f-8f72-\
e2b8b2ea9305"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Dir", "==", "\"\<Cor\>\""}], ",", 
    RowBox[{"T2ana", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"tmp2", ",", 
       RowBox[{"1", "<->", "3"}]}], "]"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.8686579693414793`*^9},ExpressionUUID->"b0eef7db-2ebd-41a2-955c-\
1c3be39d5310"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Dir", "==", "\"\<Axi\>\""}], ",", 
     RowBox[{"T1ana", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"tmp1", ",", 
        RowBox[{"1", "<->", "4"}]}], "]"}]}]}], "]"}], ";"}], " "}]], "Input",\

 CellChangeTimes->{{3.7537669188883667`*^9, 3.7537669231119633`*^9}, {
   3.753769327780789*^9, 3.7537693596920977`*^9}, {3.7559134020705833`*^9, 
   3.755913430056024*^9}, {3.755914193418326*^9, 3.755914205564002*^9}, 
   3.755914794881708*^9, {3.755914865837429*^9, 3.755914871229534*^9}, {
   3.75591502888065*^9, 3.755915029201831*^9}, 3.756177125211439*^9, {
   3.756503585426865*^9, 3.756503585537511*^9}, {3.757204378152286*^9, 
   3.757204378834485*^9}, 3.759645209735409*^9, 3.862608621219646*^9, {
   3.8626088567201853`*^9, 3.862608857510589*^9}, 3.866683368309052*^9, {
   3.866766782063569*^9, 3.866766798390678*^9}, {3.8667674318485527`*^9, 
   3.8667675338410683`*^9}, {3.867182779402803*^9, 3.8671828010810843`*^9}, {
   3.8677230829730873`*^9, 3.8677231227654467`*^9}, {3.8677239684081593`*^9, 
   3.867723968856529*^9}, 3.867724368262011*^9, 3.867728322133177*^9, 
   3.867728411460431*^9, {3.867728449484622*^9, 3.8677285136514874`*^9}, 
   3.867728618347406*^9, 3.8686492617739887`*^9, 
   3.868657978708932*^9},ExpressionUUID->"21c553ce-b1ea-4f00-9f01-\
ec906480dc25"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Dir", "==", "\"\<Axi\>\""}], ",", 
    RowBox[{"T2ana", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"tmp2", ",", 
       RowBox[{"1", "<->", "4"}]}], "]"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{3.867728682265738*^9, 
  3.868657978710573*^9},ExpressionUUID->"2f419713-ad69-4fa7-ad4b-\
82303c882634"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"tmp1", ",", "tmp2"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.866767536408621*^9, 3.8667675422796392`*^9}, {
   3.8677231261411533`*^9, 3.867723128756639*^9}, 3.867727931387095*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"17594bac-3c74-4f20-9596-a05f4715f112"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x1", "=", 
   RowBox[{"TN1", "[", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<Input1\>\"", "->", "T1ana"}], ",", 
      RowBox[{"\"\<Input2\>\"", "->", "T2ana"}]}], "|>"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.867728802863551*^9, 3.867728809882073*^9}, 
   3.8677843401898947`*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"71aebcca-015c-4fdc-b79b-36bf6889e5c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fat", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"x1", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.867724665973206*^9, 3.867724680516181*^9}, 
   3.8677843426056643`*^9, {3.8678896995419703`*^9, 3.867889733048502*^9}, {
   3.867889799653667*^9, 3.867889800171232*^9}, {3.8678906981767797`*^9, 
   3.8678907127525682`*^9}, {3.86789077563246*^9, 3.8678907779849157`*^9}, {
   3.8678909937666616`*^9, 3.867891000305461*^9}, 3.868649349109782*^9, 
   3.86865014988208*^9, {3.868650297880124*^9, 3.8686502982075787`*^9}, {
   3.868651104094225*^9, 3.868651104381732*^9}, 3.868651760013261*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"fe35eda8-1be6-4f98-88f8-d4d27b48b9fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wm", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"x1", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.867724665973206*^9, 3.867724680516181*^9}, {
   3.867724710779789*^9, 3.867724735771147*^9}, 3.867784343357469*^9, {
   3.867889742086679*^9, 3.867889762830443*^9}, {3.867889803845827*^9, 
   3.867889804325651*^9}, {3.867891005967369*^9, 3.867891026759191*^9}, {
   3.868649352237749*^9, 3.868649353397025*^9}, 3.868650152199757*^9, {
   3.868650303455851*^9, 3.868650303583572*^9}, {3.8686511089818707`*^9, 
   3.868651109125161*^9}, 3.86865276397211*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"d08fca89-0902-4900-acc6-8f6f7c7267fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mc", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"x1", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.867724665973206*^9, 3.867724680516181*^9}, {
   3.867724713059718*^9, 3.867724742155012*^9}, 3.867784343965169*^9, {
   3.8678897437028*^9, 3.8678897670542097`*^9}, {3.867889807877343*^9, 
   3.867889808374529*^9}, {3.867891006719164*^9, 3.867891028575782*^9}, 
   3.86864935629353*^9, 3.8686501540724297`*^9, {3.868650308663639*^9, 
   3.868650310111434*^9}, {3.8686511126778183`*^9, 3.868651112941091*^9}, 
   3.868652766116346*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"947dab38-1798-48a4-b2d0-992c15bf50a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dr", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"x1", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.867724665973206*^9, 3.867724680516181*^9}, {
   3.8677247148602448`*^9, 3.86772474560308*^9}, 3.867784344573146*^9, {
   3.867889744647027*^9, 3.86788977256688*^9}, {3.867889814277995*^9, 
   3.86788981480593*^9}, {3.8678910074397907`*^9, 3.8678910299337873`*^9}, 
   3.8686493595651197`*^9, 3.8686501561288548`*^9, {3.8686511168140163`*^9, 
   3.868651117157256*^9}, {3.8686527687394533`*^9, 3.868652769563195*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"50c6714a-11ed-4aa7-b1e2-6b0aa59ade9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x2", "=", 
   RowBox[{"TN2", "[", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<Input1\>\"", "->", "T1ana"}], ",", 
      RowBox[{"\"\<Input2\>\"", "->", "T2ana"}]}], "|>"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.867728802863551*^9, 3.867728809882073*^9}, 
   3.867783675864504*^9, 3.867784353189067*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"e37b4879-ba73-4dcf-95ff-a3d669d70997"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ms", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"x2", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.867724665973206*^9, 3.867724680516181*^9}, {
   3.867783654103839*^9, 3.867783654224115*^9}, 3.867784354279705*^9, {
   3.8678897797023563`*^9, 3.8678897862528133`*^9}, {3.867889818101763*^9, 
   3.867889844373857*^9}, {3.867889956636709*^9, 3.8678899712844267`*^9}, {
   3.867891009487409*^9, 3.8678910320790052`*^9}, 3.8686501603441563`*^9, {
   3.8686511228701277`*^9, 3.868651122981695*^9}, 3.8686527559318733`*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"3e353728-ab35-4ad5-b3a2-2f47c6668b59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bn", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"x2", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.867724665973206*^9, 3.867724680516181*^9}, {
   3.867724710779789*^9, 3.867724735771147*^9}, {3.86778365856831*^9, 
   3.8677836586401587`*^9}, 3.867784355173411*^9, {3.867889781175458*^9, 
   3.867889788198509*^9}, {3.867889821533801*^9, 3.8678898479653263`*^9}, {
   3.867889958173373*^9, 3.867889974500579*^9}, {3.8678910102327137`*^9, 
   3.867891032950974*^9}, 3.868650162539654*^9, {3.868651127430284*^9, 
   3.868651127501589*^9}, 3.868652753995989*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"37151f77-82b1-41d0-8857-505aaf627f45"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gm", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"x2", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.867724665973206*^9, 3.867724680516181*^9}, {
   3.867724713059718*^9, 3.867724742155012*^9}, {3.867783663799761*^9, 
   3.8677836639754343`*^9}, 3.867784356093388*^9, {3.867889781942465*^9, 
   3.8678897909041357`*^9}, {3.867889827189621*^9, 3.867889852813362*^9}, {
   3.867889959301515*^9, 3.867889976940405*^9}, {3.867891010954254*^9, 
   3.8678910336959352`*^9}, 3.8678945306826763`*^9, 3.8686501660802193`*^9, {
   3.868651131782157*^9, 3.8686511319014463`*^9}, 3.8686527517641582`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"371a2968-4271-403d-8f23-ca244d1d823a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vh", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"x2", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.867724665973206*^9, 3.867724680516181*^9}, {
   3.8677247148602448`*^9, 3.86772474560308*^9}, {3.867783668231872*^9, 
   3.8677836684877768`*^9}, 3.867784356717155*^9, {3.867889782679995*^9, 
   3.867889795171175*^9}, {3.867889832133803*^9, 3.867889856293303*^9}, {
   3.867889960500276*^9, 3.867889978645833*^9}, {3.867891011838717*^9, 
   3.867891034400423*^9}, 3.8686501691597967`*^9, {3.868651135869706*^9, 
   3.868651135973258*^9}, 3.868652748452078*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"e728b2a2-ac20-47d8-919c-c88140331923"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x3", "=", 
   RowBox[{"TN3", "[", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<Input1\>\"", "->", "T1ana"}], ",", 
      RowBox[{"\"\<Input2\>\"", "->", "T2ana"}]}], "|>"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.867728802863551*^9, 3.867728809882073*^9}, {
   3.867783675864504*^9, 3.867783699984048*^9}, 3.867784370629603*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"df36459f-cb40-4f29-bbf6-ffc9f9fa3cb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bc", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"x3", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.867724665973206*^9, 3.867724680516181*^9}, {
   3.867783654103839*^9, 3.867783654224115*^9}, {3.867783706495617*^9, 
   3.867783706639648*^9}, 3.867784371325424*^9, {3.867889869029573*^9, 
   3.867889903376112*^9}, {3.867889990020563*^9, 3.867889998452427*^9}, {
   3.867891013959446*^9, 3.8678910365338507`*^9}, 3.868650172576639*^9, {
   3.868651141502207*^9, 3.868651141597254*^9}, 3.8686527426360407`*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"84f37308-cead-47df-b7c4-28f28b9dbcd1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"crg", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"x3", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.867724665973206*^9, 3.867724680516181*^9}, {
   3.867724710779789*^9, 3.867724735771147*^9}, {3.86778365856831*^9, 
   3.8677836586401587`*^9}, {3.867783710863469*^9, 3.8677837116075897`*^9}, 
   3.867784371989656*^9, {3.867889869934298*^9, 3.867889905220086*^9}, {
   3.8678900016205072`*^9, 3.86789000865266*^9}, {3.867891014671624*^9, 
   3.867891037327983*^9}, 3.868650175432097*^9, {3.868651146198111*^9, 
   3.868651146949304*^9}, {3.868652738723412*^9, 3.868652739691002*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"9993d42d-b045-42b7-afd8-f3a1d8ea49c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"csf", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"x3", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.867724665973206*^9, 3.867724680516181*^9}, {
   3.867724713059718*^9, 3.867724742155012*^9}, {3.867783663799761*^9, 
   3.8677836639754343`*^9}, {3.8677837160634212`*^9, 3.867783716327436*^9}, 
   3.867784372692786*^9, {3.867889870941134*^9, 3.8678899069376173`*^9}, {
   3.8678900112925386`*^9, 3.867890015636606*^9}, {3.867891016631178*^9, 
   3.8678910383517647`*^9}, 3.868650178008905*^9, {3.868651149973977*^9, 
   3.8686511504695053`*^9}, 3.8686527364114923`*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"1153ed1b-7164-4499-89e7-f1ce28dfbc8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bo", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"x3", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.867724665973206*^9, 3.867724680516181*^9}, {
   3.8677247148602448`*^9, 3.86772474560308*^9}, {3.867783668231872*^9, 
   3.8677836684877768`*^9}, {3.867783720471428*^9, 3.867783720695385*^9}, 
   3.867784374612713*^9, {3.867889873102346*^9, 3.867889908881114*^9}, {
   3.8678900175340548`*^9, 3.867890025109351*^9}, {3.8678910173268337`*^9, 
   3.867891039102315*^9}, 3.868650180213182*^9, {3.86865115399059*^9, 
   3.8686511544215384`*^9}, 3.868652733947816*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"a9c1f11c-695b-48d3-bcfd-6e45307f0a0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x4", "=", 
   RowBox[{"TN4", "[", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<Input1\>\"", "->", "T1ana"}], ",", 
      RowBox[{"\"\<Input2\>\"", "->", "T2ana"}]}], "|>"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.867728802863551*^9, 3.867728809882073*^9}, 
   3.867783675864504*^9, 3.867783734224012*^9, 3.8677843830213327`*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"132ff5e9-bf3c-4ede-80a9-21e4b7387edd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sk", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"x4", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.867724665973206*^9, 3.867724680516181*^9}, {
   3.867783654103839*^9, 3.867783654224115*^9}, {3.867783743647628*^9, 
   3.8677837439116707`*^9}, 3.867784383932939*^9, {3.867889919141471*^9, 
   3.8678899385817223`*^9}, {3.867890046079204*^9, 3.867890073748451*^9}, {
   3.867891018495659*^9, 3.867891041662917*^9}, 3.868650183353421*^9, {
   3.868651157965672*^9, 3.8686511584613323`*^9}, 3.868652717796124*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"e7010b6c-f867-4670-826a-f67352b2cda5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"crw", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"x4", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.867724665973206*^9, 3.867724680516181*^9}, {
   3.867724710779789*^9, 3.867724735771147*^9}, {3.86778365856831*^9, 
   3.8677836586401587`*^9}, {3.867783749551486*^9, 3.867783750327475*^9}, 
   3.86778438457237*^9, {3.867889920085795*^9, 3.867889943932807*^9}, {
   3.867890049829084*^9, 3.8678900759888372`*^9}, {3.867891019135298*^9, 
   3.867891042486421*^9}, 3.8686501856480227`*^9, {3.868651162021206*^9, 
   3.8686511635494833`*^9}, {3.868652721196096*^9, 3.86865272150694*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"68a8cc3a-351c-4a4d-8bea-5340102d6111"],

Cell[BoxData[
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"x4", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.867724665973206*^9, 3.867724680516181*^9}, {
   3.867724710779789*^9, 3.867724735771147*^9}, {3.86778365856831*^9, 
   3.8677836586401587`*^9}, {3.867783749551486*^9, 3.867783750327475*^9}, 
   3.86778438457237*^9, {3.867788008083097*^9, 3.867788015707527*^9}, {
   3.8677939650299683`*^9, 3.867793971123233*^9}, {3.867889920894125*^9, 
   3.867889948165574*^9}, {3.867890052100662*^9, 3.86789007844462*^9}, {
   3.867891020639359*^9, 3.8678910432786818`*^9}, 3.868650189969219*^9, {
   3.868651172341885*^9, 3.868651173421307*^9}, 3.868652726052206*^9},
 CellLabel->"In[28]:=",ExpressionUUID->"c9fb7ea0-e87f-4804-ad6b-9259293f4c0d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Export", " ", "Results", " ", "in", " ", "*", 
   RowBox[{".", "mat"}], " ", "formats"}], "*)"}]], "Input",
 CellChangeTimes->{{3.868657997586768*^9, 
  3.8686580166396637`*^9}},ExpressionUUID->"6d3710a9-b6a6-462d-aced-\
1a3c176452f3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"NotebookEvaluate", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<output_results.nb\>\""}], "}"}], "]"}], "]"}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.868648854088686*^9, 3.868648863799415*^9}, {
   3.868649048078373*^9, 3.868649090853303*^9}, 3.868649700268201*^9, {
   3.868655928369416*^9, 
   3.8686559331922626`*^9}},ExpressionUUID->"207814fc-078d-4494-acd0-\
c80f4d189d53"]
},
WindowSize->{606., 659.25},
WindowMargins->{{Automatic, 152.25}, {43.5, Automatic}},
Magnification:>0.75 Inherited,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"89cadc41-64b7-4eb2-8c53-b7c534a18cf2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2033, 36, 71, "Input",ExpressionUUID->"8dd0bccb-aa89-453b-9118-092479b0adb6"],
Cell[2594, 58, 2035, 36, 71, "Input",ExpressionUUID->"93d144e9-e8d9-411a-9969-7f066bb95219"],
Cell[4632, 96, 1341, 22, 22, "Input",ExpressionUUID->"f065d9c2-0e59-4c75-b90a-d7a88e57caca"],
Cell[5976, 120, 414, 10, 22, "Input",ExpressionUUID->"32f9a0b7-5360-4a7d-8dee-0ac4a191319b"],
Cell[6393, 132, 1368, 26, 22, "Input",ExpressionUUID->"7ceebb09-2146-4b0f-8f72-e2b8b2ea9305"],
Cell[7764, 160, 367, 11, 22, "Input",ExpressionUUID->"b0eef7db-2ebd-41a2-955c-1c3be39d5310"],
Cell[8134, 173, 1380, 26, 22, "Input",ExpressionUUID->"21c553ce-b1ea-4f00-9f01-ec906480dc25"],
Cell[9517, 201, 387, 11, 22, "Input",ExpressionUUID->"2f419713-ad69-4fa7-ad4b-82303c882634"],
Cell[9907, 214, 326, 6, 22, "Input",ExpressionUUID->"17594bac-3c74-4f20-9596-a05f4715f112"],
Cell[10236, 222, 418, 11, 22, "Input",ExpressionUUID->"71aebcca-015c-4fdc-b79b-36bf6889e5c4"],
Cell[10657, 235, 779, 14, 22, "Input",ExpressionUUID->"fe35eda8-1be6-4f98-88f8-d4d27b48b9fc"],
Cell[11439, 251, 745, 14, 22, "Input",ExpressionUUID->"d08fca89-0902-4900-acc6-8f6f7c7267fd"],
Cell[12187, 267, 723, 14, 22, "Input",ExpressionUUID->"947dab38-1798-48a4-b2d0-992c15bf50a7"],
Cell[12913, 283, 705, 13, 22, "Input",ExpressionUUID->"50c6714a-11ed-4aa7-b1e2-6b0aa59ade9c"],
Cell[13621, 298, 438, 11, 22, "Input",ExpressionUUID->"e37b4879-ba73-4dcf-95ff-a3d669d70997"],
Cell[14062, 311, 708, 13, 22, "Input",ExpressionUUID->"3e353728-ab35-4ad5-b3a2-2f47c6668b59"],
Cell[14773, 326, 749, 14, 22, "Input",ExpressionUUID->"37151f77-82b1-41d0-8857-505aaf627f45"],
Cell[15525, 342, 780, 14, 22, "Input",ExpressionUUID->"371a2968-4271-403d-8f23-ca244d1d823a"],
Cell[16308, 358, 749, 14, 22, "Input",ExpressionUUID->"e728b2a2-ac20-47d8-919c-c88140331923"],
Cell[17060, 374, 462, 11, 22, "Input",ExpressionUUID->"df36459f-cb40-4f29-bbf6-ffc9f9fa3cb7"],
Cell[17525, 387, 698, 13, 22, "Input",ExpressionUUID->"84f37308-cead-47df-b7c4-28f28b9dbcd1"],
Cell[18226, 402, 773, 14, 22, "Input",ExpressionUUID->"9993d42d-b045-42b7-afd8-f3a1d8ea49c5"],
Cell[19002, 418, 759, 14, 22, "Input",ExpressionUUID->"1153ed1b-7164-4499-89e7-f1ce28dfbc8f"],
Cell[19764, 434, 752, 14, 22, "Input",ExpressionUUID->"a9c1f11c-695b-48d3-bcfd-6e45307f0a0b"],
Cell[20519, 450, 462, 11, 22, "Input",ExpressionUUID->"132ff5e9-bf3c-4ede-80a9-21e4b7387edd"],
Cell[20984, 463, 700, 13, 22, "Input",ExpressionUUID->"e7010b6c-f867-4670-826a-f67352b2cda5"],
Cell[21687, 478, 774, 14, 22, "Input",ExpressionUUID->"68a8cc3a-351c-4a4d-8bea-5340102d6111"],
Cell[22464, 494, 844, 15, 22, "Input",ExpressionUUID->"c9fb7ea0-e87f-4804-ad6b-9259293f4c0d"],
Cell[23311, 511, 276, 6, 22, "Input",ExpressionUUID->"6d3710a9-b6a6-462d-aced-1a3c176452f3"],
Cell[23590, 519, 537, 14, 22, "Input",ExpressionUUID->"207814fc-078d-4494-acd0-c80f4d189d53"]
}
]
*)

